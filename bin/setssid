#!/bin/bash

HOSTAPD_CONF="/etc/hostapd/hostapd.conf"
SSID_TOKEN={{SSID}}
HOSTAPD_CONF_TEMPLATE="/etc/pizone/hostapd.conf.template"

if [ "$(id -u)" != "0" ]; then
   echo "Script must be run as root" 1>&2
   exit 1
fi


if [ "$#" -ne 1 ]
then
        echo "Usage : setssid SSID"
        exit 1
fi

if [ ! -f $HOSTAPD_CONF_TEMPLATE ]
then
        echo "hostapd conf template not found: $HOSTAPD_CONF_TEMPLATE"
        exit 1
fi

template=$(<$HOSTAPD_CONF_TEMPLATE);
echo "${template/$SSID_TOKEN/$1}" > "$HOSTAPD_CONF"

service hostapd restart
service udhcpd restart

